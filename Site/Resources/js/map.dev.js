var NavDev={NG1:null,NG2:null,NG3:null,NG4:null,NG5:null,NTree:null,CurTreeNode:null,CurNodesPanel:null,EnmNodeType:{Null:-3,LSC:-2,Area:-1,Sta:0,Dev:1,Dic:2,Aic:3,Doc:4,Aoc:5,Str:6,Img:7,Sic:9,SS:10,RS:11,RTU:12},EnmState:{NoAlarm:0,Critical:1,Major:2,Minor:3,Hint:4,Opevent:5,Invalid:6},InitClass:function(){this.NG1=NodesGridTabPanel1;this.NG2=NodesGridTabPanel2;this.NG3=NodesGridTabPanel3;this.NG4=NodesGridTabPanel4;this.NG5=NodesGridTabPanel5;this.NTree=NavTreePanel},OnTreeItemClick:function(a,b){this.CurTreeNode=a;if(typeof(b)!="undefined"){this.ClearNodesGridStore()}if(!this.CurTreeNode.attributes.TreeNodeType){return false}switch(this.CurTreeNode.attributes.TreeNodeType){case this.EnmNodeType.Sta:break;case this.EnmNodeType.Dev:this.LoadNodesGrid();break;default:break}if(typeof(b)=="undefined"){return false}},ClearNodesGridStore:function(){this.NG1.getStore().removeAll();this.NG2.getStore().removeAll();this.NG3.getStore().removeAll();this.NG4.getStore().removeAll();this.NG5.getStore().removeAll()},LoadNodesGrid:function(){if(!this.CurTreeNode||!this.CurNodesPanel){return false}var a=this.CurTreeNode.attributes.TreeNodeType;if(a!=this.EnmNodeType.Dev){return false}switch(this.CurNodesPanel){case this.NG1:X.NavDevWnd.GetAllNodes(this.CurTreeNode.id);break;case this.NG2:X.NavDevWnd.GetDINodes(this.CurTreeNode.id);break;case this.NG3:X.NavDevWnd.GetDONodes(this.CurTreeNode.id);break;case this.NG4:X.NavDevWnd.GetAINodes(this.CurTreeNode.id);break;case this.NG5:X.NavDevWnd.GetAONodes(this.CurTreeNode.id);break;default:break}},OnNodesGridTabPanelActivate:function(a){this.CurNodesPanel=a;this.ReLoadNodesGrid()},OnFilterTextFieldClick:function(c,f){var d=DevFilterTextField,g=d.getRawValue(),a=this.NTree;a.clearFilter();if(Ext.isEmpty(g,false)){return false}var b=new RegExp(".*"+g+".*","i");a.filterBy(function(i){var h=b.test(i.text.replace(/<span>&nbsp;<\/span>/g,"")),e=i.parentNode;if(h&&i.isLeaf()){e.hasMatchNode=true}if(e!=null&&e.fixed){if(i.isLeaf()===false){i.fixed=true}return true}if(i.isLeaf()===false){i.fixed=h;return h}return(e!=null&&e.fixed)||h},{expandNodes:false});a.getRootNode().cascade(function(e){if(e.isRoot){return}if(e.isLeaf()===false){e.expand(false,false)}delete e.fixed;delete e.hasMatchNode},a)},SetGridNodesRowColor:function(a){switch(a.data.Status){case NavDev.EnmState.NoAlarm:return"grid-bg-NoAlarm";case NavDev.EnmState.Critical:return"grid-bg-Critical";case NavDev.EnmState.Major:return"grid-bg-Major";case NavDev.EnmState.Minor:return"grid-bg-Minor";case NavDev.EnmState.Hint:return"grid-bg-Hint";case NavDev.EnmState.Opevent:return"grid-bg-Opevent";case NavDev.EnmState.Invalid:return"grid-bg-Invalid";default:return"grid-bg-NoAlarm"}},PrepareCommand:function(b,d,a,c){switch(a.data.NodeType){case NavDev.EnmNodeType.Doc:if(d.command==="Set"){d.hidden=true;d.hideMode="display"}break;case NavDev.EnmNodeType.Aoc:if(d.command==="Ctrl"){d.hidden=true;d.hideMode="display"}break;default:d.hidden=true;d.hideMode="display";break}},OnNodesGridTabPanelCmdClick:function(c,a,d,b){X.NavDevWnd.ShowControlWindow(c,a.data.LscID,a.data.NodeID,a.data.NodeType,a.data.NodeName)},ReLoadNodesGrid:function(){if(this.CurTreeNode&&this.CurNodesPanel){this.NTree.fireEvent("click",this.CurTreeNode)}},OnNodesGridRowContextMenuShow:function(a,c,b){b.preventDefault();a.getSelectionModel().selectRow(c);NodesGridRowMenu.dataRecord=a.store.getAt(c);NodesGridRowMenu.showAt(b.getXY())}};
